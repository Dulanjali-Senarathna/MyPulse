{"version":3,"sources":["../../src/pages/paired-devices/paired-devices.module.ts","../../src/pages/paired-devices/paired-devices.ts"],"names":[],"mappings":"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","file":"6.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { PairedDevicesPage } from './paired-devices';\n\n@NgModule({\n  declarations: [\n    PairedDevicesPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(PairedDevicesPage),\n  ],\n})\nexport class PairedDevicesPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/paired-devices/paired-devices.module.ts","import {Component, OnInit} from '@angular/core';\nimport {\n  IonicPage, NavController, NavParams, LoadingController, AlertController, Loading,\n  ViewController\n} from 'ionic-angular';\nimport {BluetoothService} from \"../../providers/bluetooth/bluetooth.service\";\nimport {StorageService} from \"../../providers/storage/storage.service\";\nimport {isArray} from \"ionic-angular/util/util\";\n\n@IonicPage()\n@Component({\n  selector: 'page-paired-devices',\n  templateUrl: 'paired-devices.html'\n})\nexport class PairedDevicesPage implements OnInit {\n  public pairedDevices: any[] = [];\n  public availableDevices: any[] = [];\n  public searchResult = {\n    message: '',\n    type: ''\n  };\n  public loading: boolean;\n  public result: string[] = [];\n  constructor(private btSvc: BluetoothService, private lsService: StorageService, private viewCtrl: ViewController) {\n    /*this.pairedDevices.push({id: 'Unknown', name: '00:A0:C9:14:C8', 'connected': true});\n     this.pairedDevices.push({id: 'Unknown', name: '00:A0:C9:14:C8'});\n     this.availableDevices.push({id: 'Unknown', name: '00:A0:C9:14:C8'});\n     this.availableDevices.push({id: 'Unknown', name: '00:A0:C9:14:C8'});\n     this.loading = true;\n     this.searchResult = {\n     message: 'no devices found.',\n     type: 'warn'\n     };*/\n\n  }\n\n  ngOnInit() {\n    this.init();\n  }\n  init() {\n    this.lsService.getPairedDevices().then(devices => {\n      if (devices != null && isArray(devices)) {\n        this.pairedDevices = devices;\n      }\n    })\n  }\n\n  turnOnBluetooth() {\n    this.btSvc.turnOnBluetooth().then(sucess => {\n      if (sucess === 'BLUETOOTH.ALREADY_AVAILABLE') {\n        this.searchResult = { message: 'bluetooth is already turned on.' , type: 'warn'};\n      }  else {\n        this.searchResult = { message: 'bluetooth turned on.' , type: ''}\n      }\n    }).catch(fail => {\n      if (fail === 'BLUETOOTH.ALREADY_AVAILABLE') {\n        this.searchResult = { message: 'no devices found.' , type: 'warn'};\n      }  else {\n        this.searchResult = { message: 'bluetooth not available.' , type: 'warn'};\n      }\n    });\n  }\n\n  startListening() {\n    this.btSvc.startListen('Start').then(data => {\n      this.searchResult = { message: 'start listening.' , type: ''};\n      this.btSvc.tagdata.subscribe(data => {\n        this.searchResult = { message: JSON.stringify(data) , type: 'info'};\n      })\n    }).catch(fail => {\n      this.searchResult = { message: 'scanner not connected.' , type: 'warn'};\n    })\n  }\n  searchDevices() {\n    this.loading = true;\n    this.btSvc.searchBluetooth().then((devices: Array<Object>) => {\n      if (devices && isArray(devices)) {\n        this.availableDevices = this.removeDuplicates(devices);\n      }\n      this.searchResult = { message: this.availableDevices.length + ' new bluetooth devices found.' , type: ''};\n      this.loading = false;\n    }).catch(fail => {\n      if (fail === 'BLUETOOTH.NO_DEVICES_FOUND') {\n        this.searchResult = { message: 'no devices found.' , type: 'warn'};\n      }  else {\n        this.searchResult = { message: 'bluetooth not available.' , type: 'warn'};\n      }\n      this.loading = false;\n\n    });\n  }\n\n  removeDuplicates(devices: any[]): any[] {\n    let filtered = [];\n    devices.forEach(d => {\n      let index = filtered.findIndex(fd => fd.id === d.id);\n      if (index === -1) {\n        if (!d['name'] || d['name'] === '') {\n          d['name'] = 'Unknown'\n        }\n        filtered.push(d);\n      }\n    });\n    return filtered;\n  }\n  connectDevice(device: any) {\n    this.loading = true;\n    this.pairedDevices.forEach(device => {\n      device['connected'] = false;\n    });\n    this.btSvc.deviceConnection(device).then(data => {\n      device['connected'] = true;\n      let index = this.pairedDevices.findIndex(d => d.id === device.id);\n      if (index === -1 ) {\n        this.pairedDevices.push(device);\n      }\n      this.searchResult = { message: device['name'] + ' successfully connected.' , type: ''};\n      this.startListening();\n      this.loading = false;\n    }).catch(fail => {\n      this.searchResult = {message: 'cannot connect device.' , type: 'warn'};\n      this.loading = false;\n\n    });\n  }\n\n  closeModal() {\n    this.viewCtrl.dismiss();\n\n  }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/paired-devices/paired-devices.ts"],"sourceRoot":""}